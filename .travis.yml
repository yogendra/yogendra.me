language: node_js
node_js:
- lts/*
cache:
  npm: true
  directories:
  - node_modules
  - themes/tranquilpeak/node_modules
before_install:
- openssl aes-256-cbc -K $encrypted_df2bd5da7d4c_key -iv $encrypted_df2bd5da7d4c_iv -in deploy_rsa.enc -out deploy_rsa -d
- echo -e "Host github.com\n\tHostName github.com\n\tUser git\n\tIdentityFile $TRAVIS_BUILD_DIR/deploy_rsa\n" >> ~/.ssh/config
- export PATH=$TRAVIS_BUILD_DIR/node_modules/.bin:$PATH
install:
- npm install
script:
- npm run build:prod:github
- npm run build:prod:firebase
deploy:
- provider: firebase
  token:
    secure: ChOI6fVipYgGLK3oBgZw0BJSdcezk5qxo1hrDVSKnYgg1nvoJYQeijFKa/GZ3+DUjWxT3LdPwLxFnjiL47JTbrz+HGjHUQkBgn/MqdFqZbHZ55EfOxmz/byUhe2T+/hoByDED5205Qw4h88n4XZjbaGIQjwFSqL+gYZrU43v7vKUrXakdiDj/IY4/7KMTWEszauq/zjHe+bqakAhN0Tdc+km+KBao2fd3YWHZKqc0VYFfl7fdsCX0FLFR7shrDWqhQuVVVJ14Swe9vTQVq+Ovc2fn5lQGAj4IIWz+AdhiqlECa7BSJifHCEjb7VMtrf8ptjyXDXg8+0SI3xJBlKkb9XtXO9e8YP3H9IoBZ2+pdZksmA+q56qxmXZmwJPhmllPZEN3zJ/WJ7H1u88wTrs3aK7V3Ws7kQWhqX43Td8saBwz8u0O1vLPEjg+tAu6naiODkaV9GeC0ACXjIHnUsXMiDACYWasv254TfclfAG0f/l78ZjQhlc5iBY/ITQVkb7B6V4PLBSpiCmozBtDbHXWs4oACitST51BOHZmlTuCmISF9sNmWgnjeg5BSSAIQC8YYYDLOb0O0nU2V8hCgkFjWIXdfRC5i9VyAD1Z/jNt8nWKPTdHKCERmyLRGsnRxygsZBsfagGH4woNPqDpk8UWmbaz82IBlKigqEbyPeHtLA=
  skip_cleanup: true
  on:
    branch: master
- provider: script
  script: "npm run deploy:github"
  on:
    branch: master
notifications:
  email:
    on_failure: always
